from enigmapython.EnigmaZRotorI import EnigmaZRotorI
from enigmapython.EnigmaZRotorII import EnigmaZRotorII
from enigmapython.EnigmaZRotorIII import EnigmaZRotorIII
from enigmapython.EnigmaZEtw import EnigmaZEtw
from enigmapython.EnigmaZ import EnigmaZ
from enigmapython.ReflectorZUKW import ReflectorZUKW
import unittest


class TestEnigmaZ(unittest.TestCase):

    def test_enigma_Z_reflector_increment(self):
        rotor1 = EnigmaZRotorI()
        rotor2 = EnigmaZRotorI()
        rotor3 = EnigmaZRotorI()
        reflector = ReflectorZUKW()
        etw = EnigmaZEtw()
        enigma = EnigmaZ(rotor3, rotor2, rotor1, reflector, etw, True)
        cleartext = '1'*1000
        my_encrypted_string = enigma.input_string(cleartext)
        self.assertEqual(reflector.position,1,"Enigma encryption error")

    def test_enigma_Z_rotors_I_I_I_small_number(self):
        rotor1 = EnigmaZRotorI()
        rotor2 = EnigmaZRotorI()
        rotor3 = EnigmaZRotorI()
        reflector = ReflectorZUKW()
        etw = EnigmaZEtw()
        enigma = EnigmaZ(rotor3, rotor2, rotor1, reflector, etw, True)
        cleartext = '23041981'
        my_encrypted_string = enigma.input_string(cleartext)
        self.assertEqual(my_encrypted_string,"95539350","Enigma encryption error")

    def test_enigma_Z_rotors_I_I_I_medium_number(self):
        rotor1 = EnigmaZRotorI()
        rotor2 = EnigmaZRotorI()
        rotor3 = EnigmaZRotorI()
        reflector = ReflectorZUKW()
        etw = EnigmaZEtw()
        enigma = EnigmaZ(rotor3, rotor2, rotor1, reflector, etw, True)
        cleartext = '123456789012345678901234567890'
        my_encrypted_string = enigma.input_string(cleartext)
        self.assertEqual(my_encrypted_string,"719365648926063110712103315478","Enigma encryption error")

    def test_enigma_Z_rotors_I_I_I_long_number(self):
        rotor1 = EnigmaZRotorI()
        rotor2 = EnigmaZRotorI()
        rotor3 = EnigmaZRotorI()
        reflector = ReflectorZUKW()
        etw = EnigmaZEtw()
        enigma = EnigmaZ(rotor3, rotor2, rotor1, reflector, etw, True)
        cleartext = '123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'
        my_encrypted_string = enigma.input_string(cleartext)
        self.assertEqual(my_encrypted_string,"719365648926063110712103315478649268658141631204469499646181818397946868524735118183979464949864668933966860886892656584097183330649798501019113249431315348841101033134738885954263297682300869728735053657471915365747191328152842322820773753201522423796480416274448080627286517424479718353099666141045251729593457112393330855484216260931117920460020293656481016","Enigma encryption error")

    def test_enigma_Z_rotors_I_I_I_long_long_number(self):
        rotor1 = EnigmaZRotorI()
        rotor2 = EnigmaZRotorI()
        rotor3 = EnigmaZRotorI()
        reflector = ReflectorZUKW()
        etw = EnigmaZEtw()
        enigma = EnigmaZ(rotor3, rotor2, rotor1, reflector, etw, True)
        cleartext = '123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'
        my_encrypted_string = enigma.input_string(cleartext)
        self.assertEqual(my_encrypted_string,"719365648926063110712103315478649268658141631204469499646181818397946868524735118183979464949864668933966860886892656584097183330649798501019113249431315348841101033134738885954263297682300869728735053657471915365747191328152842322820773753201522423796480416274448080627286517424479718353099666141045251729593457112393330855484216260931117920460020293656481016997584420868926865886862179544005143531357450542212113285436905944811181839024644851430313710331847320053142714103310478689265658131033134786442002524097183930248207707520520799754982074975774986266879818243634571123933486819313617153428418685240251957966860862609311172097985310866420715258387975961315348841325651942462669171143808595426436514313154347070927","Enigma encryption error")

    def test_enigma_Z_rotors_I_I_I_very_long_number(self):
       rotor1 = EnigmaZRotorI()
       rotor2 = EnigmaZRotorI()
       rotor3 = EnigmaZRotorI()
       reflector = ReflectorZUKW()
       etw = EnigmaZEtw()
       enigma = EnigmaZ(rotor3, rotor2, rotor1, reflector, etw, True)
       cleartext = '719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478719365648926063110712103315478'
       my_encrypted_string = enigma.input_string(cleartext)
       self.assertEqual(my_encrypted_string,"123456789012345678901234567890973652709707480846297886904062325440081480112553304214243835333653709059641098469759401119456012174597574969104284973866921421983830325645969659441119446014174430112963338015250236607581920211601757461919231137562774895562879279696366126042862974315708287966533485989267604104832243207707568669151147087584220015946238838465150247362077175709681056464719281139554701992591574209101264177844581721993535976449868529751157121422283611395631907234568890073956719700385646997796626089355040171477112353344971833305095940411169430084266389971161355240851532277479508244052820070931917039641008431835564296486016174472112273375018247636921421983611798821031815284232562776095582277579575018226633975040171185936584821810294734362671905171430484251447002920573752799559470099207234568894175640301180237584529450490717362074175143631484454947032920977582820869420035297636560094426414884410112963330035560296603859769218601747467919231137362174835462112273394766126045828496386212207777551437567997983654709843420845247871804302337583020488112533304214280835157587520843325655904264126840570737597705986236899056447014605640501394554452180522703551605140531197534284175948032623328497286655996491836345042220874606302709788026083032569590607586020892524375191966137043938693506354450892289852404512604809062384758522003214209830476611904480112543329050490716262078175119631084454917230931962272855862420875297686926064595740491169839084661529771152355640001562470479200244002820476911914139631084401234567896257588820843728825080662126545140839567488112533329050498713608197536394554962150747002921362776595702889276675528787652924407082665996801830865144242486616004185936584888012257537398197436267601757454747072929585740291892524275146371877304831923313708681446461529781156456217554443112453344071826306590737497015946238875018247634262678505692594471180522726551486114834477112963330045042226601829263218708727066319281137862174335702287276575768126643062879065700480306296396680081834203352334651302483962139545180839867265906707898896654087991829463665996801887892674584845940311472112373323490699785153957719257601797451997638986962974815705986966830885984264604809862278207707568469151147083154739055946298838765158247358097176243601757454717226939580731997891524235141071877304531723593598574449160529781151590734497364859962631525773252605640001262400777260529701157496914414143631284401264177846004601902599574049169959431113258098176559879099604234560891944201952831728825023680999760600839867394554802180992633583848899366458112393323520799755194107432243708727053797679980581726093672899371697526747052931923013364758822080892684582456819064187237584575918237633054809062543470309296396626081830233357334859332683032569595140839567291504707120890694781251228553643798421047671826305190937417085946538875098648683258698506697594961180942032521603957719099544058164989931163558792896557277299508284957864024401982030748428033525749250573752799088849538623520799752062172035167335684950687926969426412284110430384247471847304605240551198534484143971839303398197436055946498875648042620274608202619798021083432569590087586020872420375296366147041931223553334758822089852484512600839067384257502575818204633540839567334355602908294653880877587320705986356893526749055195640401243809757686392673582938093176255906797851817204934486611904871420965241471803306533753799558375699909254488819943252759035946438848871854304097582420077345658975488926669223458789650899391646371848302270938817384758522020680993765162879865188237584558527758953098192436043440968237745072224033953719059440098266389901161456212854537277969508284953866020431987030345608939855444219074809262581470509226390698781862276355130839384653737569995140032177271400707227890694784925440081115936384891836564094333653709374450442287442002520373859769459112093304234568895320431987314651242475738563699223458789699594041137525770251391226453443112843364089971165994809462565976209875898674684825440381672899371633435569295143956719251601797421090698786205240251191534484141971838303398696406050440498275748002620274008172679798021003234569890143859769030345608908294650880877582320707681356493986939065125440881260809757696396643082887584320878227965533465149247601124533243708727069659481117607584220314257232575468100643124401982518375649903234569890273158739709889046697636560091345240251411112853324480993765345240251131631484448771858309397586420090544458175748072620271028173679899041666339561192825440381119237084561439561197353654709543470449207244002820377581920439112033304234560895333653709059641098469759401119456012174597574969104284973866921421983830325645969659441119496914414468112963333085979266605140831212207777568619251137062974215012641278431465126246446016174432112873388012257536947581920411112853321810294732562777095582879579656317226932520432387314257232575438563697023454789643395641937525726259397586420443112333344071870305994604402565976969839855474214605040171272809777664439561197943954719851621295421660198746123457789010345658904234560890573752799707681246497986937064325440881460112453394526743055262178535707788226075648082625124407282685996501836365148243888696306705986966888042052527436013174450112293375018200636426411984611691961431915233236562776895562375679999056426019194606402562375679909254477810975040171702889876694836564092945940011881621555421610293736496114434467112963331045072226605640201212400777266319201137862974315702681276401264126846828496386212207777551437567997983654709843420845247871804302337583020488112533304214280835555740591143839284675528726652320437087665996431830045042220476616504199534084180032567591162271955700480446246371880301294208452039641008475968130641280238857665996801898886954067446111934437112843388042052526247588220419112053326310290731862277355702889876656387926962538793596258809797653527709952486117034865926965840671843306436613204118335684989452487519426417084410112353394036560096533753799314651242487912237534362879865462112473394526726055601829263691594801187992638583848996316450112393323790699785154007172277708727053997639980857587320843227855584462126547540734597443112233329050497714607587520394554432150527700951538793896250809797650527700952486819064868621965440971833306436113834168335684999756487019551724593643899961637525726252600937017265906737860099641187456614504197534284180962137541486114834477112963330045042226601829263218708727066319281137862174335702287276575768126643043752799039849038668529751152057582020567375659900284926869426411984130839384646371847302604007172599574059164919231133558791996551879299601234567894544701992531778429023520799750151022173643395631907214226830070931917701385636991096626089555740591597574359140971833301880839367374257202575498643687821424383643798321033525789255197586420243207737575098670683456917014443112353394086926066530733897314257232588012257534062879565092544478130525726251973652709085946538829850494714062072175177335684954487926969923452789850420395247671848304062172035707480336296346082021034203252334355602986362126549880839367705986306848871854307880237357374257452544471843307591724493043748228075528787654297588420643297431575528770653070839567384450502226390693781862277355135936384853527749955190632407243400707287892674584274809262581470509226390698781862276355130839384653737569995140032177271400707227890694784120431987314355642901234563890273658709709480046297526700051395240451443112853304284973865937583020855926395891866104044436613504374450962289452403516603859769354355692909254408819077581920880420545226360190741262278555139631084459957430911600232857364450802297886904064243158739037748828088642052525147582220487112553326380998763828497386700889966656347042922055940011143430384296386926061330233857334257432588042052520070839567099544008130835564291328491986218601747453737569999283158739899524045147671870301331223253418112843364489981165601921913699594041167989931163258998816559277099508294650881054201952037748828033985939260244108032537778329098646052025137583220384859552686332568593848899366701889966626340092722323456789012345678901234567890973652709707480846297886904062325440081480112553304214243835333653709059641098469759401119456012174597574969104284973866921421983830325645969659441119446014174430112963338015250236607581920211601757461919231137562774895562879279696366126042862974315708287966533485989267604104832243207707568669151147087584220015946238838465150247362077175709681056464719281139554701992591574209101264177844581721993535976449868529751157121422283611395631907234568890073956719700385646997796626089355040171477112353344971833305095940411169430084266389971161355240851532277479508244052820070931917039641008431835564296486016174472112273375018247636921421983611798821031815284232562776095582277579575018226633975040171185936584821810294734362671905171430484251447002920573752799559470099207234568894175640301180237584529450490717362074175143631484454947032920977582820869420035297636560094426414884410112963330035560296603859769218601747467919231137362174835462112273394766126045828496386212207777551437567997983654709843420845247871804302337583020488112533304214280835157587520843325655904264126840570737597705986236899056447014605640501394554452180522703551605140531197534284175948032623328497286655996491836345042220874606302709788026083032569590607586020892524375191966137043938693506354450892289852404512604809062384758522003214209830476611904480112543329050490716262078175119631084454917230931962272855862420875297686926064595740491169839084661529771152355640001562470479200244002820476911914139631084401234567896257588820843728825080662126545140839567488112533329050498713608197536394554962150747002921362776595702889276675528787652924407082665996801830865144242486616004185936584888012257537398197436267601757454747072929585740291892524275146371877304831923313708681446461529781156456217554443112453344071826306590737497015946238875018247634262678505692594471180522726551486114834477112963330045042226601829263218708727066319281137862174335702287276575768126643062879065700480306296396680081834203352334651302483962139545180839867265906707898896654087991829463665996801887892674584845940311472112373323490699785153957719257601797451997638986962974815705986966830885984264604809862278207707568469151147083154739055946298838765158247358097176243601757454717226939580731997891524235141071877304531723593598574449160529781151590734497364859962631525773252605640001262400777260529701157496914414143631284401264177846004601902599574049169959431113258098176559879099604234560891944201952831728825023680999760600839867394554802180992633583848899366458112393323520799755194107432243708727053797679980581726093672899371697526747052931923013364758822080892684582456819064187237584575918237633054809062543470309296396626081830233357334859332683032569595140839567291504707120890694781251228553643798421047671826305190937417085946538875098648683258698506697594961180942032521603957719099544058164989931163558792896557277299508284957864024401982030748428033525749250573752799088849538623520799752062172035167335684950687926969426412284110430384247471847304605240551198534484143971839303398197436055946498875648042620274608202619798021083432569590","Enigma encryption error")

   
if __name__ == "__main__":
    unittest.main(verbosity=2)